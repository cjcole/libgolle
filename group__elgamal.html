<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>libgolle: ElGamal</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">libgolle
   &#160;<span id="projectnumber">0.0.0</span>
   </div>
   <div id="projectbrief">Phillipe Golle&#39;s protocol for Mental Poker</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__elgamal.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ElGamal</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga8added1398404d4505b991e8d522fb8a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="platform_8h.html#a003d459507dc9739a74e5d10325c100b">GOLLE_EXTERN</a> <a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748">golle_error</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__elgamal.html#ga8added1398404d4505b991e8d522fb8a">golle_eg_encrypt</a> (<a class="el" href="structgolle__key__t.html">golle_key_t</a> *key, <a class="el" href="group__numbers.html#gad713bce25ecfb150e1cac5d2c03093f5">golle_num_t</a> m, <a class="el" href="group__numbers.html#gad713bce25ecfb150e1cac5d2c03093f5">golle_num_t</a> a, <a class="el" href="group__numbers.html#gad713bce25ecfb150e1cac5d2c03093f5">golle_num_t</a> b, <a class="el" href="group__numbers.html#gad713bce25ecfb150e1cac5d2c03093f5">golle_num_t</a> *rand)</td></tr>
<tr class="memdesc:ga8added1398404d4505b991e8d522fb8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypt a number <img class="formulaInl" alt="$m \in \mathbb{G}_{q}$" src="form_26.png"/>.  <a href="#ga8added1398404d4505b991e8d522fb8a"></a><br/></td></tr>
<tr class="memitem:ga3320d0fbaf0241743e5e84b0b21c02d3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="platform_8h.html#a003d459507dc9739a74e5d10325c100b">GOLLE_EXTERN</a> <a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748">golle_error</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__elgamal.html#ga3320d0fbaf0241743e5e84b0b21c02d3">golle_eg_decrypt</a> (<a class="el" href="structgolle__key__t.html">golle_key_t</a> *key, <a class="el" href="group__numbers.html#gad713bce25ecfb150e1cac5d2c03093f5">golle_num_t</a> *xi, size_t len, <a class="el" href="group__numbers.html#gad713bce25ecfb150e1cac5d2c03093f5">golle_num_t</a> a, <a class="el" href="group__numbers.html#gad713bce25ecfb150e1cac5d2c03093f5">golle_num_t</a> b, <a class="el" href="group__numbers.html#gad713bce25ecfb150e1cac5d2c03093f5">golle_num_t</a> m)</td></tr>
<tr class="memdesc:ga3320d0fbaf0241743e5e84b0b21c02d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypt a message.  <a href="#ga3320d0fbaf0241743e5e84b0b21c02d3"></a><br/></td></tr>
</table>
<a name="details" id="details"></a><h2>Detailed Description</h2>
<p>Given a <a class="el" href="structgolle__key__t.html" title="A peer&#39;s key. Contains the peer&#39;s portion of the private key and the public key elements.">golle_key_t</a> structure properly generated so that the user has a the full public key in <code>h_product</code>, this module allows the user to encrypt a message that the group can then work together to decrypt.</p>
<p>Given a <a class="el" href="structgolle__key__t.html" title="A peer&#39;s key. Contains the peer&#39;s portion of the private key and the public key elements.">golle_key_t</a> struct properly generated so that the user has part of the private key in <code>x</code>, this module allows the user to partially decrypt a message that was encrypted by another group member, as above.</p>
<p>To encrypt a message <img class="formulaInl" alt="$m \in \mathbb{G}$" src="form_19.png"/> using ElGamal, we select <img class="formulaInl" alt="$r \xleftarrow{R} \{\mathbb{Z}^{*}_{q}\}$" src="form_20.png"/>, then calculate the ciphertext <img class="formulaInl" alt="$c = (g^{r}, mh^{r})$" src="form_21.png"/>.</p>
<p>To decrypt a ciphertext <img class="formulaInl" alt="$(a, b)$" src="form_22.png"/>, we calculate <img class="formulaInl" alt="$b/a^{x}$" src="form_23.png"/>, where <img class="formulaInl" alt="$a^{x} = \prod_{i=1}^{k}a^{x_{i}}$" src="form_24.png"/> for each of the <img class="formulaInl" alt="$k$" src="form_25.png"/> members of the group.</p>
<p>Decryption is not needed by the Golle protocol, although we include it here for verification and completeness. For more information on how ElGamal is used in the Golle protocol, see <a class="el" href="group__golle.html">Golle state functions</a>. </p>
<h2>Function Documentation</h2>
<a class="anchor" id="ga3320d0fbaf0241743e5e84b0b21c02d3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="platform_8h.html#a003d459507dc9739a74e5d10325c100b">GOLLE_EXTERN</a> <a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748">golle_error</a> golle_eg_decrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgolle__key__t.html">golle_key_t</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__numbers.html#gad713bce25ecfb150e1cac5d2c03093f5">golle_num_t</a> *&#160;</td>
          <td class="paramname"><em>xi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__numbers.html#gad713bce25ecfb150e1cac5d2c03093f5">golle_num_t</a>&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__numbers.html#gad713bce25ecfb150e1cac5d2c03093f5">golle_num_t</a>&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__numbers.html#gad713bce25ecfb150e1cac5d2c03093f5">golle_num_t</a>&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypt a message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>The key containing the primes used for modulus operations. </td></tr>
    <tr><td class="paramname">xi</td><td>An array of private key values, for each member of the group. </td></tr>
    <tr><td class="paramname">len</td><td>The number of keys in <code>xi</code>. </td></tr>
    <tr><td class="paramname">a</td><td>The first value of the ciphertext returned by <a class="el" href="group__elgamal.html#ga8added1398404d4505b991e8d522fb8a" title="Encrypt a number .">golle_eg_encrypt()</a>. </td></tr>
    <tr><td class="paramname">b</td><td>The second value returned by <a class="el" href="group__elgamal.html#ga8added1398404d4505b991e8d522fb8a" title="Encrypt a number .">golle_eg_encrypt()</a>. </td></tr>
    <tr><td class="paramname">m</td><td>The decrypted number. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748abd824663c8b698a8579794715affa307">GOLLE_ERROR</a> if any parameter is <code>NULL</code> or if <code>len</code> is <code>0</code>. <a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748abcc532a9199501961553efd02a4f5e07">GOLLE_ECRYPTO</a> if an error occurs during cryptography. <a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748a376d7929ff0724f11bbda0669c21d65b">GOLLE_EMEM</a> if memory allocation fails. <a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748abc2291f52f5966c55ff93414a091d661">GOLLE_OK</a> if successful. </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>This function is never actually called during the Golle protocol. it is provided here for completeness of the ElGamal cryptosystem and for the purposes of testing. You may, however, use it as a general purpose cryptosystem if encryption is asymmetric, with one encryptor and one decryptor. </dd></dl>

</div>
</div>
<a class="anchor" id="ga8added1398404d4505b991e8d522fb8a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="platform_8h.html#a003d459507dc9739a74e5d10325c100b">GOLLE_EXTERN</a> <a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748">golle_error</a> golle_eg_encrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgolle__key__t.html">golle_key_t</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__numbers.html#gad713bce25ecfb150e1cac5d2c03093f5">golle_num_t</a>&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__numbers.html#gad713bce25ecfb150e1cac5d2c03093f5">golle_num_t</a>&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__numbers.html#gad713bce25ecfb150e1cac5d2c03093f5">golle_num_t</a>&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__numbers.html#gad713bce25ecfb150e1cac5d2c03093f5">golle_num_t</a> *&#160;</td>
          <td class="paramname"><em>rand</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypt a number <img class="formulaInl" alt="$m \in \mathbb{G}_{q}$" src="form_26.png"/>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>The ElGamal public key to use during encryption. </td></tr>
    <tr><td class="paramname">m</td><td>The number to encrypt. <img class="formulaInl" alt="$msg \in \mathbb{G}_{q}$" src="form_27.png"/> </td></tr>
    <tr><td class="paramname">a</td><td>Will receive the value of <img class="formulaInl" alt="$c_{1}$" src="form_28.png"/>. </td></tr>
    <tr><td class="paramname">b</td><td>Will receive the value of <img class="formulaInl" alt="$c_{2}$" src="form_29.png"/>. </td></tr>
    <tr><td class="paramname">rand</td><td>If the value pointed to is not <code>NULL</code>, it will be used as the random value <img class="formulaInl" alt="$r \in \mathbb{Z}^{*}_{q}$" src="form_30.png"/>. Otherwise, a random value will be collected and returned as new number, via <a class="el" href="group__numbers.html#ga42b0ea114c71b1f06e9a66cb64f192f9" title="Create a new number.">golle_num_new()</a>. If the argument itself is <code>NULL</code>, then a random value will be generated but not returned. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748abd824663c8b698a8579794715affa307">GOLLE_ERROR</a> if any parameter is <code>NULL</code>. <a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748a5c181218a4fb29ec6c0ec4141fd4d8a6">GOLLE_EOUTOFRANGE</a> if <img class="formulaInl" alt="$m >= {q}$" src="form_48.png"/>. <a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748abcc532a9199501961553efd02a4f5e07">GOLLE_ECRYPTO</a> if an error happens during cryptography. <a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748a376d7929ff0724f11bbda0669c21d65b">GOLLE_EMEM</a> if memory allocation fails. <a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748abc2291f52f5966c55ff93414a091d661">GOLLE_OK</a> if successful. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>It is assumed that <img class="formulaInl" alt="$m \in \mathbb{G}_{q}$" src="form_26.png"/> by computing <img class="formulaInl" alt="$ m = g^{n} \mod q$" src="form_32.png"/> prior to encrypting. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sat Apr 19 2014 00:06:23 for libgolle by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.1.2 </li>
  </ul>
</div>
</body>
</html>
