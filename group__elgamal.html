<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>LibGolle: ElGamal</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">LibGolle
   &#160;<span id="projectnumber">0.0.0</span>
   </div>
   <div id="projectbrief">Phillipe Golle&#39;s protocol for Mental Poker</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__elgamal.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ElGamal</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structgolle__eg__t.html">golle_eg_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">ElGamal ciphertex.  <a href="structgolle__eg__t.html#details">More...</a><br/></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga44102246e661487fb90e0a82272e62c3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga44102246e661487fb90e0a82272e62c3"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__elgamal.html#ga44102246e661487fb90e0a82272e62c3">GOLLE_EG_FULL</a>(C)&#160;&#160;&#160;((C) &amp;&amp; (C)-&gt;a &amp;&amp; (C)-&gt;b)</td></tr>
<tr class="memdesc:ga44102246e661487fb90e0a82272e62c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check whether the structure is full (both parameters are present). <br/></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga5f638172acd6292dd82fd0154e3e634a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="platform_8h.html#a22aa8f08d7b06ebc8d08e23227d1c5e8">GOLLE_INLINE</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__elgamal.html#ga5f638172acd6292dd82fd0154e3e634a">golle_eg_clear</a> (<a class="el" href="structgolle__eg__t.html">golle_eg_t</a> *cipher)</td></tr>
<tr class="memdesc:ga5f638172acd6292dd82fd0154e3e634a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear memory allocated for the ciphertext.  <a href="#ga5f638172acd6292dd82fd0154e3e634a"></a><br/></td></tr>
<tr class="memitem:gabc51023a2b4da74b85a20c19ef773337"><td class="memItemLeft" align="right" valign="top"><a class="el" href="platform_8h.html#a003d459507dc9739a74e5d10325c100b">GOLLE_EXTERN</a> <a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748">golle_error</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__elgamal.html#gabc51023a2b4da74b85a20c19ef773337">golle_eg_encrypt</a> (const <a class="el" href="structgolle__key__t.html">golle_key_t</a> *key, const <a class="el" href="group__numbers.html#gad713bce25ecfb150e1cac5d2c03093f5">golle_num_t</a> m, <a class="el" href="structgolle__eg__t.html">golle_eg_t</a> *cipher, <a class="el" href="group__numbers.html#gad713bce25ecfb150e1cac5d2c03093f5">golle_num_t</a> *rand)</td></tr>
<tr class="memdesc:gabc51023a2b4da74b85a20c19ef773337"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypt a number <img class="formulaInl" alt="$m \in \mathbb{G}_{q}$" src="form_26.png"/>.  <a href="#gabc51023a2b4da74b85a20c19ef773337"></a><br/></td></tr>
<tr class="memitem:ga77c78e711aca27abe9d45ae8367fe57c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="platform_8h.html#a003d459507dc9739a74e5d10325c100b">GOLLE_EXTERN</a> <a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748">golle_error</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__elgamal.html#ga77c78e711aca27abe9d45ae8367fe57c">golle_eg_reencrypt</a> (const <a class="el" href="structgolle__key__t.html">golle_key_t</a> *key, const <a class="el" href="structgolle__eg__t.html">golle_eg_t</a> *e1, <a class="el" href="structgolle__eg__t.html">golle_eg_t</a> *e2, <a class="el" href="group__numbers.html#gad713bce25ecfb150e1cac5d2c03093f5">golle_num_t</a> *rand)</td></tr>
<tr class="memdesc:ga77c78e711aca27abe9d45ae8367fe57c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Re-encrypt a message (as in the <a class="el" href="group__pep.html">Plaintext Equivalence Proof</a>). The resulting ciphertext, for a random <img class="formulaInl" alt="$r \in \mathbb{Z}_{q}$" src="form_51.png"/> will be <img class="formulaInl" alt="$(ag^{t}, bh^{r})$" src="form_66.png"/>.  <a href="#ga77c78e711aca27abe9d45ae8367fe57c"></a><br/></td></tr>
<tr class="memitem:ga1ac8e1a180e14755fffa4a87e2e01e3b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="platform_8h.html#a003d459507dc9739a74e5d10325c100b">GOLLE_EXTERN</a> <a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748">golle_error</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__elgamal.html#ga1ac8e1a180e14755fffa4a87e2e01e3b">golle_eg_decrypt</a> (const <a class="el" href="structgolle__key__t.html">golle_key_t</a> *key, const <a class="el" href="group__numbers.html#gad713bce25ecfb150e1cac5d2c03093f5">golle_num_t</a> *xi, size_t len, const <a class="el" href="structgolle__eg__t.html">golle_eg_t</a> *cipher, <a class="el" href="group__numbers.html#gad713bce25ecfb150e1cac5d2c03093f5">golle_num_t</a> m)</td></tr>
<tr class="memdesc:ga1ac8e1a180e14755fffa4a87e2e01e3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypt a message.  <a href="#ga1ac8e1a180e14755fffa4a87e2e01e3b"></a><br/></td></tr>
</table>
<a name="details" id="details"></a><h2>Detailed Description</h2>
<p>Given a <a class="el" href="structgolle__key__t.html" title="A peer&#39;s key. Contains the peer&#39;s portion of the private key and the public key elements.">golle_key_t</a> structure properly generated so that the user has a the full public key in <code>h_product</code>, this module allows the user to encrypt a message that the group can then work together to decrypt.</p>
<p>Given a <a class="el" href="structgolle__key__t.html" title="A peer&#39;s key. Contains the peer&#39;s portion of the private key and the public key elements.">golle_key_t</a> struct properly generated so that the user has part of the private key in <code>x</code>, this module allows the user to partially decrypt a message that was encrypted by another group member, as above.</p>
<p>To encrypt a message <img class="formulaInl" alt="$m \in \mathbb{G}$" src="form_19.png"/> using ElGamal, we select <img class="formulaInl" alt="$r \xleftarrow{R} \{\mathbb{Z}^{*}_{q}\}$" src="form_20.png"/>, then calculate the ciphertext <img class="formulaInl" alt="$c = (g^{r}, mh^{r})$" src="form_21.png"/>.</p>
<p>To decrypt a ciphertext <img class="formulaInl" alt="$(a, b)$" src="form_22.png"/>, we calculate <img class="formulaInl" alt="$b/a^{x}$" src="form_23.png"/>, where <img class="formulaInl" alt="$a^{x} = \prod_{i=1}^{k}a^{x_{i}}$" src="form_24.png"/> for each of the <img class="formulaInl" alt="$k$" src="form_25.png"/> members of the group.</p>
<p>Decryption is not needed by the Golle protocol, although we include it here for verification and completeness. </p>
<h2>Function Documentation</h2>
<a class="anchor" id="ga5f638172acd6292dd82fd0154e3e634a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="platform_8h.html#a22aa8f08d7b06ebc8d08e23227d1c5e8">GOLLE_INLINE</a> void golle_eg_clear </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgolle__eg__t.html">golle_eg_t</a> *&#160;</td>
          <td class="paramname"><em>cipher</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clear memory allocated for the ciphertext. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cipher</td><td>The ciphertext to clear. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga1ac8e1a180e14755fffa4a87e2e01e3b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="platform_8h.html#a003d459507dc9739a74e5d10325c100b">GOLLE_EXTERN</a> <a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748">golle_error</a> golle_eg_decrypt </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structgolle__key__t.html">golle_key_t</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__numbers.html#gad713bce25ecfb150e1cac5d2c03093f5">golle_num_t</a> *&#160;</td>
          <td class="paramname"><em>xi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structgolle__eg__t.html">golle_eg_t</a> *&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__numbers.html#gad713bce25ecfb150e1cac5d2c03093f5">golle_num_t</a>&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypt a message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>The key containing the primes used for modulus operations. </td></tr>
    <tr><td class="paramname">xi</td><td>An array of private key values, for each member of the group. </td></tr>
    <tr><td class="paramname">len</td><td>The number of keys in <code>xi</code>. </td></tr>
    <tr><td class="paramname">cipher</td><td>A non-<code>NULL</code> ciphertext value from <a class="el" href="group__elgamal.html#gabc51023a2b4da74b85a20c19ef773337" title="Encrypt a number .">golle_eg_encrypt()</a>. </td></tr>
    <tr><td class="paramname">m</td><td>The decrypted number. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748abd824663c8b698a8579794715affa307">GOLLE_ERROR</a> if any parameter is <code>NULL</code> or if <code>len</code> is <code>0</code>. <a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748abcc532a9199501961553efd02a4f5e07">GOLLE_ECRYPTO</a> if an error occurs during cryptography. <a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748a376d7929ff0724f11bbda0669c21d65b">GOLLE_EMEM</a> if memory allocation fails. <a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748abc2291f52f5966c55ff93414a091d661">GOLLE_OK</a> if successful. </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>This function is never actually called during the Golle protocol. it is provided here for completeness of the ElGamal cryptosystem and for the purposes of testing. You may, however, use it as a general purpose cryptosystem if encryption is asymmetric, with one encryptor and one decryptor. </dd></dl>

</div>
</div>
<a class="anchor" id="gabc51023a2b4da74b85a20c19ef773337"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="platform_8h.html#a003d459507dc9739a74e5d10325c100b">GOLLE_EXTERN</a> <a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748">golle_error</a> golle_eg_encrypt </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structgolle__key__t.html">golle_key_t</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__numbers.html#gad713bce25ecfb150e1cac5d2c03093f5">golle_num_t</a>&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structgolle__eg__t.html">golle_eg_t</a> *&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__numbers.html#gad713bce25ecfb150e1cac5d2c03093f5">golle_num_t</a> *&#160;</td>
          <td class="paramname"><em>rand</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypt a number <img class="formulaInl" alt="$m \in \mathbb{G}_{q}$" src="form_26.png"/>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">key</td><td>The ElGamal public key to use during encryption. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">m</td><td>The number to encrypt. <img class="formulaInl" alt="$msg \in \mathbb{G}_{q}$" src="form_27.png"/> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cipher</td><td>A non-<code>NULL</code> <a class="el" href="structgolle__eg__t.html" title="ElGamal ciphertex.">golle_eg_t</a> structure. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">rand</td><td>If the value pointed to is not <code>NULL</code>, it will be used as the random value <img class="formulaInl" alt="$r \in \mathbb{Z}^{*}_{q}$" src="form_28.png"/>. Otherwise, a random value will be collected and returned as new number, via <a class="el" href="group__numbers.html#gaa83f0cbd6388011b68c9a27b340af36f" title="Create a new number.">golle_num_new()</a>. If the argument itself is <code>NULL</code>, then a random value will be generated but not returned. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748abd824663c8b698a8579794715affa307">GOLLE_ERROR</a> if any parameter is <code>NULL</code>. <a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748a5c181218a4fb29ec6c0ec4141fd4d8a6">GOLLE_EOUTOFRANGE</a> if <img class="formulaInl" alt="$m >= {q}$" src="form_29.png"/>. <a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748abcc532a9199501961553efd02a4f5e07">GOLLE_ECRYPTO</a> if an error happens during cryptography. <a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748a376d7929ff0724f11bbda0669c21d65b">GOLLE_EMEM</a> if memory allocation fails. <a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748abc2291f52f5966c55ff93414a091d661">GOLLE_OK</a> if successful. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>It is assumed that <img class="formulaInl" alt="$m \in \mathbb{G}_{q}$" src="form_26.png"/> by computing <img class="formulaInl" alt="$ m = g^{n} \mod q$" src="form_30.png"/> prior to encrypting. </dd></dl>

</div>
</div>
<a class="anchor" id="ga77c78e711aca27abe9d45ae8367fe57c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="platform_8h.html#a003d459507dc9739a74e5d10325c100b">GOLLE_EXTERN</a> <a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748">golle_error</a> golle_eg_reencrypt </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structgolle__key__t.html">golle_key_t</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structgolle__eg__t.html">golle_eg_t</a> *&#160;</td>
          <td class="paramname"><em>e1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structgolle__eg__t.html">golle_eg_t</a> *&#160;</td>
          <td class="paramname"><em>e2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__numbers.html#gad713bce25ecfb150e1cac5d2c03093f5">golle_num_t</a> *&#160;</td>
          <td class="paramname"><em>rand</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Re-encrypt a message (as in the <a class="el" href="group__pep.html">Plaintext Equivalence Proof</a>). The resulting ciphertext, for a random <img class="formulaInl" alt="$r \in \mathbb{Z}_{q}$" src="form_51.png"/> will be <img class="formulaInl" alt="$(ag^{t}, bh^{r})$" src="form_66.png"/>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">key</td><td>The ElGamal public key used to encrypt the first ciphertext. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">e1</td><td>The first ciphertext, already encrypted. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">e2</td><td>A non-<code>NULL</code> <a class="el" href="structgolle__eg__t.html" title="ElGamal ciphertex.">golle_eg_t</a> structure. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">rand</td><td>If the value pointed to is not <code>NULL</code>, it will be used as the random value <img class="formulaInl" alt="$r \in \mathbb{Z}^{*}_{q}$" src="form_28.png"/>. Otherwise, a random value will be collected and returned as new number, via <a class="el" href="group__numbers.html#gaa83f0cbd6388011b68c9a27b340af36f" title="Create a new number.">golle_num_new()</a>. If the argument itself is <code>NULL</code>, then a random value will be generated but not returned. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748abd824663c8b698a8579794715affa307">GOLLE_ERROR</a> if any parameter is <code>NULL</code>. <a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748abcc532a9199501961553efd02a4f5e07">GOLLE_ECRYPTO</a> if an error happens during cryptography. <a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748a376d7929ff0724f11bbda0669c21d65b">GOLLE_EMEM</a> if memory allocation fails. <a class="el" href="errors_8h.html#ad89bfc18c1698005d61cc709e5626748abc2291f52f5966c55ff93414a091d661">GOLLE_OK</a> if successful. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu May 22 2014 23:54:47 for LibGolle by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.1.2 </li>
  </ul>
</div>
</body>
</html>
